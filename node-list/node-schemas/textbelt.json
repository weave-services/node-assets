{
  "id": "textbelt",
  "label": "Textbelt",
  "name": "textbelt",
  "type": "action",
  "module": "http",
  "version": 1,
  "description": "Send SMS/MMS charts, check delivery status & quota, and handle OTP verification with Textbelt.",
  "incoming": 1,
  "outgoing": 1,

  "actions": [
    {
      "label": "API",
      "name": "api",
      "type": "options",
      "options": [
        { "label": "Send SMS", "name": "send_text", "description": "POST /text — Send an SMS message." },
        { "label": "Send Chart MMS", "name": "send_chart", "description": "POST /sms-chart — Send an MMS with a chart image." },
        { "label": "Get Delivery Status", "name": "get_status", "description": "GET /status/:textId — Check SMS delivery status." },
        { "label": "Get Quota", "name": "get_quota", "description": "GET /quota/:key — Check remaining SMS credits." },
        { "label": "OTP Generate", "name": "otp_generate", "description": "POST /otp/generate — Send an OTP code to a phone." },
        { "label": "OTP Verify", "name": "otp_verify", "description": "GET /otp/verify — Verify a submitted OTP code." }
      ],
      "default": "send_text"
    }
  ],

  "inputParameters": [

    {
      "label": "API Key (override)",
      "name": "key",
      "type": "string",
      "required": false,
      "description": "Optional per-call key override. If omitted, uses the saved credential."
    },


    {
      "label": "Phone",
      "name": "phone",
      "type": "string",
      "description": "E.164 recommended (e.g., +15551234567).",
      "show": { "actions.api": ["send_text", "send_chart", "otp_generate"] }
    },
    {
      "label": "Message",
      "name": "message",
      "type": "string",
      "description": "SMS body content.",
      "show": { "actions.api": ["send_text", "send_chart"] }
    },
    {
      "label": "Sender (regulatory)",
      "name": "sender",
      "type": "string",
      "required": false,
      "description": "Business/organization name for compliance (not usually shown to end users).",
      "show": { "actions.api": ["send_text"] }
    },
    {
      "label": "Reply Webhook URL",
      "name": "replyWebhookUrl",
      "type": "string",
      "required": false,
      "description": "HTTPS endpoint to receive user replies (U.S. only).",
      "show": { "actions.api": ["send_text"] }
    },
    {
      "label": "Webhook Data",
      "name": "webhookData",
      "type": "string",
      "required": false,
      "description": "Arbitrary string (<= 100 chars) to include in reply webhook payload as `data`.",
      "show": { "actions.api": ["send_text"] }
    },


    {
      "label": "Simple Chart Data",
      "name": "data",
      "type": "string",
      "required": false,
      "description": "Comma-separated numbers (e.g., \"1,2,3,4\"). Use for simple line/bar charts.",
      "show": { "actions.api": ["send_chart"] }
    },
    {
      "label": "Simple Chart Type",
      "name": "type",
      "type": "string",
      "required": false,
      "default": "line",
      "description": "Chart type: 'line' or 'bar' (simple charts).",
      "show": { "actions.api": ["send_chart"] }
    },
    {
      "label": "Chart Title",
      "name": "title",
      "type": "string",
      "required": false,
      "description": "Optional title above the chart.",
      "show": { "actions.api": ["send_chart"] }
    },
    {
      "label": "X-Axis Labels",
      "name": "labels",
      "type": "string",
      "required": false,
      "description": "Comma-separated labels for x-axis.",
      "show": { "actions.api": ["send_chart"] }
    },
    {
      "label": "Custom Chart.js Definition",
      "name": "chart",
      "type": "string",
      "required": false,
      "description": "Full Chart.js config JSON for complex charts.",
      "show": { "actions.api": ["send_chart"] }
    },
    {
      "label": "Chart Background Color",
      "name": "backgroundColor",
      "type": "string",
      "required": false,
      "description": "Hex color for chart canvas background (e.g., 0xffcccc).",
      "show": { "actions.api": ["send_chart"] }
    },

 
    {
      "label": "Text ID",
      "name": "textId",
      "type": "string",
      "description": "ID returned by send endpoints, used to query delivery status.",
      "show": { "actions.api": ["get_status"] }
    },


    {
      "label": "Quota Key (override)",
      "name": "quotaKey",
      "type": "string",
      "required": false,
      "description": "If set, will be used as the `:key` path param for quota lookup. Otherwise uses credential/key.",
      "show": { "actions.api": ["get_quota"] }
    },

    {
      "label": "User ID",
      "name": "userid",
      "type": "string",
      "description": "Unique identifier for the user (string).",
      "show": { "actions.api": ["otp_generate", "otp_verify"] }
    },
    {
      "label": "Custom OTP Message",
      "name": "otp_message",
      "type": "string",
      "required": false,
      "description": "Custom OTP SMS. Use `$OTP` placeholder to inject the code.",
      "show": { "actions.api": ["otp_generate"] }
    },
    {
      "label": "OTP Lifetime (seconds)",
      "name": "lifetime",
      "type": "number",
      "required": false,
      "default": 180,
      "description": "Validity window in seconds.",
      "show": { "actions.api": ["otp_generate"] }
    },
    {
      "label": "OTP Length",
      "name": "length",
      "type": "number",
      "required": false,
      "default": 6,
      "description": "Number of digits in the OTP.",
      "show": { "actions.api": ["otp_generate"] }
    },
    {
      "label": "OTP Code",
      "name": "otp",
      "type": "string",
      "description": "Code provided by the user for verification.",
      "show": { "actions.api": ["otp_verify"] }
    }
  ],

  "credentials": [
    {
      "label": "Textbelt API Key",
      "name": "apiKey",
      "type": "string",
      "required": true,
      "description": "Textbelt API key used when `key` parameter is not provided.",
      "credentialMethod": "textbeltApiKey"
    }
  ],

  "category": "Messaging",
  "icons": {
    "default": "https://raw.githubusercontent.com/weave-services/node-assets/main/nodes/Textbelt/default.svg",
    "light": "https://raw.githubusercontent.com/weave-services/node-assets/main/nodes/Textbelt/light.svg",
    "dark": "https://raw.githubusercontent.com/weave-services/node-assets/main/nodes/Textbelt/dark.svg"
  },
  "color": "#111827",
  "tags": ["sms", "mms", "charts", "otp", "verification", "status", "quota", "alerts"],

  "examples": [
    {
      "name": "Send SMS",
      "description": "Basic SMS send using credential key",
      "inputParameters": {
        "phone": "+15555555555",
        "message": "Hello world from Textbelt!"
      },
      "actions": { "api": "send_text" }
    },
    {
      "name": "Send Chart MMS (Simple)",
      "description": "Send a bar chart via MMS",
      "inputParameters": {
        "phone": "+15555555555",
        "message": "Latency spike detected",
        "data": "80,42,30,30,165",
        "title": "Latency",
        "labels": "Sun,Mon,Tues,Wed,Thu"
      },
      "actions": { "api": "send_chart" }
    },
    {
      "name": "Check Delivery Status",
      "description": "Look up message delivery",
      "inputParameters": {
        "textId": "12345"
      },
      "actions": { "api": "get_status" }
    },
    {
      "name": "Check Quota",
      "description": "See remaining credits for this key",
      "inputParameters": {},
      "actions": { "api": "get_quota" }
    },
    {
      "name": "Generate OTP",
      "description": "Send a one-time password to a user",
      "inputParameters": {
        "phone": "+15555555555",
        "userid": "user_abc123",
        "lifetime": 180,
        "length": 6
      },
      "actions": { "api": "otp_generate" }
    },
    {
      "name": "Verify OTP",
      "description": "Validate an OTP code provided by user",
      "inputParameters": {
        "userid": "user_abc123",
        "otp": "123456"
      },
      "actions": { "api": "otp_verify" }
    }
  ],

  "documentation": "https://docs.textbelt.com/"
}
