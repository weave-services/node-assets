{
  "label": "Agent Engine",
  "name": "agentEngine",
  "icons": {
    "default": "https://raw.githubusercontent.com/weave-services/node-assets/refs/heads/main/node-list/node-schemas/agent2.png",
    "light": "https://raw.githubusercontent.com/weave-services/node-assets/refs/heads/main/node-list/node-schemas/agent2.png",
    "dark": "https://raw.githubusercontent.com/weave-services/node-assets/refs/heads/main/node-list/node-schemas/agent2.png"
  },
  "type": "action",
  "category": "Artificial Intelligence",
  "version": 2,
  "description": "Reentrant Agent (Plan → Tool → Agent → Parser/Complete). Tools & parser are attached by edges, not parameters.",
  "incoming": 1,
  "outgoing": 1,
  "ports": {
    "outgoing": [
      {
        "label": "Tool",
        "handle": "tool",
        "multiplicity": "many",
        "required": false,
        "description": "Attach any number of tool nodes from this handle."
      },
      {
        "label": "Parser",
        "handle": "parser",
        "multiplicity": "zero_or_one",
        "required": false,
        "description": "Attach one structured output parser (optional)."
      }
    ]
  },

  "actions": [
    {
      "label": "Operation",
      "name": "operation",
      "type": "options",
      "options": [
        { "label": "Plan & Act (Reentrant)", "name": "planAct" },
        { "label": "Parse Only (no planning)", "name": "parseOnly" }
      ],
      "default": "planAct"
    }
  ],

  "credentials": [
    {
      "label": "Credential Method",
      "name": "credentialMethod",
      "type": "options",
      "options": [{ "label": "OpenAI API Key", "name": "openAIApi" }],
      "default": "openAIApi"
    }
  ],

  "inputParameters": [
    {
      "label": "Reentrant",
      "name": "reentrant",
      "type": "boolean",
      "description": "Enable agent reentrancy (tool → agent → next).",
      "default": true
    },
    {
      "label": "Model",
      "name": "model",
      "type": "options",
      "options": [
        { "label": "gpt-4o", "name": "gpt-4o" },
        { "label": "gpt-4o-mini", "name": "gpt-4o-mini" },
        { "label": "gpt-4.1", "name": "gpt-4.1" },
        { "label": "gpt-4.1-mini", "name": "gpt-4.1-mini" },
        { "label": "o1-preview", "name": "o1-preview" },
        { "label": "o1-mini", "name": "o1-mini" }
      ],
      "default": "gpt-4o-mini",
      "description": "AI model used by the agent."
    },
    {
      "label": "Planning: Max Steps",
      "name": "planning_maxSteps",
      "type": "number",
      "description": "Maximum planning turns before completion.",
      "default": 8,
      "show": { "actions.operation": ["planAct"] }
    },
    {
      "label": "Allow Parallel Tools",
      "name": "planning_allowParallelTools",
      "type": "boolean",
      "description": "If true, the agent may plan parallel tool calls (runner may still serialize).",
      "default": false,
      "show": { "actions.operation": ["planAct"] }
    },
    {
      "label": "Memory Type",
      "name": "memory_type",
      "type": "options",
      "options": [
        { "label": "Buffer", "name": "buffer" },
        { "label": "Summary", "name": "summary" },
        { "label": "Vector", "name": "vector" }
      ],
      "default": "buffer",
      "description": "Agent memory strategy.",
      "show": { "actions.operation": ["planAct"] }
    },
    {
      "label": "Memory Max Turns",
      "name": "memory_maxTurns",
      "type": "number",
      "default": 20,
      "description": "Maximum conversation turns to retain.",
      "show": { "actions.operation": ["planAct"] }
    },
    {
      "label": "Max Tokens",
      "name": "max_tokens",
      "type": "number",
      "description": "Maximum tokens to generate per agent step.",
      "optional": true,
      "default": 4096
    },
    {
      "label": "Top P",
      "name": "top_p",
      "type": "number",
      "description": "Nucleus sampling parameter (0..1).",
      "optional": true,
      "default": 1.0
    },
    {
      "label": "Temperature",
      "name": "temperature",
      "type": "number",
      "description": "Controls randomness (0..1).",
      "optional": true,
      "default": 0.7
    },
    {
      "label": "Stream",
      "name": "stream",
      "type": "boolean",
      "description": "Stream tokens as they arrive.",
      "optional": true,
      "default": false
    },
    {
      "label": "System Prompt",
      "name": "system_prompt",
      "type": "string",
      "default": "",
      "placeholder": "You are a helpful agent that plans tool calls...",
      "description": "System instruction for the agent.",
      "optional": true
    },
    {
      "label": "User Prompt",
      "name": "user_prompt",
      "type": "string",
      "default": "",
      "placeholder": "Summarize results and decide next action.",
      "description": "Primary user/task prompt.",
      "optional": true
    }
  ],

  "validation": {
    "rules": [
      {
        "kind": "edgeMultiplicity",
        "handle": "parser",
        "max": 1,
        "message": "Only one parser may be attached to the 'parser' handle."
      }
    ]
  },

  "filePath": "https://raw.githubusercontent.com/weave-services/node-assets/refs/heads/main/node-list/runners/AgentEngine.ts"
}
